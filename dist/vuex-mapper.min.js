/**
 * vuex-mapper v1.0.0-alpha.2
 * (c) 2018 Ben Delsol <ben.t.delsol@gmail.com>
 * @license MIT
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VuexMapper=t()}(this,function(){"use strict";function j(e){return Object.defineProperty(e.data(),"id",{value:e.id})}var a=function(e){return e&&"object"==typeof e},u=function(e){return e.toDate},s=function(e){return e&&e.onSnapshot};function p(r,o,i,e){void 0===i&&(i=""),void 0===e&&(e=[{},{}]),o=o||{};var t=Object.getOwnPropertyDescriptor(r,"id");return t&&!t.enumerable&&Object.defineProperty(e[0],"id",t),Object.keys(r).reduce(function(e,t){var n=r[t];return s(n)?(e[0][t]=o[t]||n.path,e[1][i+t]=n):Array.isArray(n)?(e[0][t]=Array(n.length).fill(null),p(n,o[t],i+t+".",[e[0][t],e[1]])):null==n||n instanceof Date||u(n)||n.longitude&&n.latitude?e[0][t]=n:a(n)?(e[0][t]={},p(n,o[t],i+t+".",[e[0][t],e[1]])):e[0][t]=n,e},e)}function v(e,t){return t.split(".").reduce(function(e,t){return e[t]},e)}var e,R="vuexfire/SET_VALUE",$="vuexfire/ARRAY_ADD",g="vuexfire/ARRAY_REMOVE",r=((e={})[R]=function(e,t){var n,r,o,i,a,u=t.path,s=t.target,c=t.data;n=s,r=c,o=(""+u).split("."),i=o.pop(),a=o.reduce(function(e,t){return e[t]},n),isFinite(i)?a.splice(i,1,r):a[i]=r},e[$]=function(e,t){var n=t.newIndex,r=t.data;t.target.splice(n,0,r)},e[g]=function(e,t){var n=t.oldIndex;return t.target.splice(n,1)[0]},e),t={},O={root:!0};function A(e){for(var t in e)e[t].unsub()}function x(e,h){var p=e.subs,v=e.refs,$=e.target,g=e.path,x=(e.data,e.depth),b=e.commit,y=e.resolve,t=Object.keys(v);if(Object.keys(p).filter(function(e){return t.indexOf(e)<0}).forEach(function(e){p[e].unsub(),delete p[e]}),!t.length||++x>h.maxRefDepth)return y(g);var _=0,M=t.length,w=Object.create(null);t.forEach(function(e){var t,n,r,o,i,a,u,s,c,d,l=p[e],f=v[e],m=g+"."+e;if(w[m]=!0,l){if(l.path===f.path)return;l.unsub()}p[e]={unsub:(t={ref:f,target:$,path:m,depth:x,commit:b,resolve:function(e){e in w&&++_>=M&&y(g)}.bind(null,m)},n=h,r=t.ref,o=t.target,i=t.path,a=t.depth,u=t.commit,s=t.resolve,c=Object.create(null),d=r.onSnapshot(function(e){e.exists?C({snapshot:j(e),target:o,path:i,subs:c,depth:a,commit:u,resolve:s},n):(u(R,{target:o,path:i,data:null},O),s(i))}),function(){d(),A(c)}),path:f.path}})}function C(e,t){var n=e.snapshot,r=e.target,o=e.path,i=e.subs,a=e.depth;void 0===a&&(a=0);var u=e.commit,s=e.resolve,c=p(n,v(r,o)),d=c[0],l=c[1];u(R,{path:o,target:r,data:d},O),x({data:d,subs:i,refs:l,target:r,path:o,depth:a,commit:u,resolve:s},t)}Object.keys(r).forEach(function(n){t[n]=function(e,t){r[n](t.state,t)}});var c=new WeakMap;function i(e,n){var r=e.state,o=e.commit,i=e.key,a=e.ref;void 0===n&&(n={maxRefDepth:2});var u=c.get(o);return u||(u=Object.create(null),c.set(o,u)),i in u&&d({commit:o,key:i}),new Promise(function(e,t){u[i]=a.where?function(e,c){var i=e.vm,a=e.key,t=e.collection,d=e.commit,l=e.resolve,n=e.reject;d(R,{path:a,target:i,data:[]},O);var u,f=v(i,a),s=l,m=[],h={added:function(e){var t=e.newIndex,n=e.doc;m.splice(t,0,Object.create(null));var r=m[t],o=p(j(n)),i=o[0],a=o[1];d($,{target:f,newIndex:t,data:i},O),x({data:i,refs:a,subs:r,target:f,path:t,depth:0,commit:d,resolve:l.bind(null,n)},c)},modified:function(e){var t=e.oldIndex,n=e.newIndex,r=e.doc,o=m.splice(t,1)[0];m.splice(n,0,o);var i=d(g,{target:f,oldIndex:t},O),a=p(j(r),i),u=a[0],s=a[1];d($,{target:f,newIndex:n,data:u},O),x({data:u,refs:s,subs:o,target:f,path:n,depth:0,commit:d,resolve:l},c)},removed:function(e){var t=e.oldIndex;d(g,{target:f,oldIndex:t},O),A(m.splice(t,1)[0])}},r=t.onSnapshot(function(e){var t="function"==typeof e.docChanges?e.docChanges():e.docChanges;if(!u&&t.length){u=!0;var n=0,r=t.length,o=t.reduce(function(e,t){return e[t.doc.id]=!1,e},Object.create(null));l=function(e){e.id in o&&++n>=r&&(s(i[a]),l=function(e){})}}t.forEach(function(e){h[e.type](e)}),t.length||l()},n);return function(){r(),m.forEach(A)}}({vm:r,key:i,collection:a,commit:o,resolve:e,reject:t},n):function(e,t){var n,r,o,i=e.vm,a=e.key,u=e.document,s=e.commit,c=e.resolve,d=e.reject,l=Object.create(null);n=c,r=function(){return i[a]},c=function(){if(!o)return o=!0,n(r())};var f=u.onSnapshot(function(e){e.exists?C({snapshot:j(e),target:i,path:a,subs:l,commit:s,resolve:c},t):c()},d);return function(){f(),A(l)}}({vm:r,key:i,document:a,commit:o,resolve:e,reject:t},n)})}function d(e){var t=e.commit,n=e.key,r=c.get(t);r&&(r[n](),delete r[n])}function o(n){return function(e,t){var r=e.state,o=e.commit;return e.bindFirebaseRef=function(e,t,n){return void 0===n&&(n={}),i({state:r,commit:o,key:e,ref:t},n)},e.unbindFirebaseRef=function(e){return d({commit:o,key:e})},n(e,t)}}var n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var l,b=(function(e,t){var n;n=function(){var n=[],r=[],i={},o={},a={};function u(e){return"string"==typeof e?new RegExp("^"+e+"$","i"):e}function s(e,t){return e===t?t:e===e.toUpperCase()?t.toUpperCase():e[0]===e[0].toUpperCase()?t.charAt(0).toUpperCase()+t.substr(1).toLowerCase():t.toLowerCase()}function c(i,a){return i.replace(a[0],function(e,t){var n,r,o=(n=a[1],r=arguments,n.replace(/\$(\d{1,2})/g,function(e,t){return r[t]||""}));return s(""===e?i[t-1]:e,o)})}function d(e,t,n){if(!e.length||i.hasOwnProperty(e))return t;for(var r=n.length;r--;){var o=n[r];if(o[0].test(t))return c(t,o)}return t}function e(n,r,o){return function(e){var t=e.toLowerCase();return r.hasOwnProperty(t)?s(e,t):n.hasOwnProperty(t)?s(e,n[t]):d(t,e,o)}}function t(n,r,o,e){return function(e){var t=e.toLowerCase();return!!r.hasOwnProperty(t)||!n.hasOwnProperty(t)&&d(t,t,o)===t}}function l(e,t,n){return(n?t+" ":"")+(1===t?l.singular(e):l.plural(e))}return l.plural=e(a,o,n),l.isPlural=t(a,o,n),l.singular=e(o,a,r),l.isSingular=t(o,a,r),l.addPluralRule=function(e,t){n.push([u(e),t])},l.addSingularRule=function(e,t){r.push([u(e),t])},l.addUncountableRule=function(e){"string"!=typeof e?(l.addPluralRule(e,"$0"),l.addSingularRule(e,"$0")):i[e.toLowerCase()]=!0},l.addIrregularRule=function(e,t){t=t.toLowerCase(),e=e.toLowerCase(),a[e]=t,o[t]=e},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["whiskey","whiskies"]].forEach(function(e){return l.addIrregularRule(e[0],e[1])}),[[/s?$/i,"s"],[/[^\u0000-\u007F]$/i,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|tlas|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[emjzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/(m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach(function(e){return l.addPluralRule(e[0],e[1])}),[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/(m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|tlas|gas|(?:her|at|gr)o|ris)(?:es)?$/i,"$1"],[/(analy|ba|diagno|parenthe|progno|synop|the|empha|cri)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach(function(e){return l.addSingularRule(e[0],e[1])}),["adulthood","advice","agenda","aid","alcohol","ammo","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","flounder","fun","gallows","garbage","graffiti","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","manga","news","pike","plankton","pliers","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","species","staff","swine","tennis","traffic","transporation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(l.addUncountableRule),l},e.exports=n()}(l={exports:{}},l.exports),l.exports),f=1/0,m="[object Symbol]",h=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,y=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_="\\ud800-\\udfff",M="\\u2700-\\u27bf",w="a-z\\xdf-\\xf6\\xf8-\\xff",I="A-Z\\xc0-\\xd6\\xd8-\\xde",k="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",E="['\u2019]",N="["+k+"]",S="[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]",D="\\d+",P="["+M+"]",U="["+w+"]",z="[^"+_+k+D+M+w+I+"]",L="(?:\\ud83c[\\udde6-\\uddff]){2}",T="[\\ud800-\\udbff][\\udc00-\\udfff]",q="["+I+"]",K="(?:"+U+"|"+z+")",F="(?:"+q+"|"+z+")",Z="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",W="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Y="(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?",G="[\\ufe0e\\ufe0f]?",V=G+Y+("(?:\\u200d(?:"+["[^"+_+"]",L,T].join("|")+")"+G+Y+")*"),B="(?:"+[P,L,T].join("|")+")"+V,H=RegExp(E,"g"),J=RegExp(S,"g"),Q=RegExp([q+"?"+U+"+"+Z+"(?="+[N,q,"$"].join("|")+")",F+"+"+W+"(?="+[N,q+K,"$"].join("|")+")",q+"?"+K+"+"+Z,q+"+"+W,D,B].join("|"),"g"),X=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ee="object"==typeof n&&n&&n.Object===Object&&n,te="object"==typeof self&&self&&self.Object===Object&&self,ne=ee||te||Function("return this")();var re,oe=(re={"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"ss"},function(e){return null==re?void 0:re[e]});var ie,ae=Object.prototype.toString,ue=ne.Symbol,se=ue?ue.prototype:void 0,ce=se?se.toString:void 0;function de(e){if("string"==typeof e)return e;if("symbol"==typeof(t=e)||(n=t)&&"object"==typeof n&&ae.call(t)==m)return ce?ce.call(e):"";var t,n,r=e+"";return"0"==r&&1/e==-f?"-0":r}function le(e){return null==e?"":de(e)}var fe=(ie=function(e,t,n){return e+(n?"-":"")+t.toLowerCase()},function(e){return function(e,t,n,r){var o=-1,i=e?e.length:0;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}((t=le(t=(i=e,(i=le(i))&&i.replace(y,oe).replace(J,"")).replace(H,"")),void 0===(n=r?void 0:n)?(o=t,X.test(o)?t.match(Q)||[]:t.match(h)||[]):t.match(n)||[]),ie,"");var t,n,r,o,i}),me={},he=function(e,t){return e.where("authorId","==",t.rootState.user.uid).orderBy("createdAt","asc")},pe={},ve={},$e=function(e,t){var n=t.currentTime;this.requireModule=e,this.currentTime=n};return $e.prototype.lookupModel=function(e){var t=b.singular(e),n="./"+fe(t);return this.requireModule(n).default},$e.prototype.vuexModule=function(e){var t=e.name,n=e.joinsWith,u=t,s=(n||[]).map(function(e){return[u,e].sort().join("_")}),a=this.currentTime;return{namespaced:!0,modules:{},state:function(){var e={refKey:""};return e[u]=[],e},getters:{},mutations:{setRef:function(e,t){var n=t.ref,r=t.parentDocId;e.refKey=r?u+"-"+r:u,me[e.refKey]=n}},actions:{setRef:o(function(e,t){var n=t.ref,r=t.parentDocId;if(me[e.state.refKey]&&n.isEqual(me[e.state.refKey]))return Promise.resolve();e.commit("setRef",{ref:n,parentDocId:r});var o=he(me[e.state.refKey],e);return e.bindFirebaseRef(u,o)}),unsetRef:o(function(e){var t=e.state;(0,e.unbindFirebaseRef)(u),delete me[t.refKey]}),addWithId:function(e,t){var n=e.state,r=e.rootState,o=e.dispatch;void 0===t&&(t={});var i=me[n.refKey].doc(t.id);return delete t.id,o("saveTransaction",i.set(Object.assign({},t,{authorId:r.user.uid,createdAt:a()})),{root:!0})},add:function(e,t){var n=e.state,r=e.rootState;return void 0===t&&(t={}),(0,e.dispatch)("saveTransaction",me[n.refKey].add(Object.assign({},t,{authorId:r.user.uid,createdAt:a()})),{root:!0})},update:function(e,t){var n=e.state,r=e.dispatch,o=t.id,i=Object.assign({},t);return delete i.id,r("saveTransaction",me[n.refKey].doc(o).update(i),{root:!0})},get:function(t){return he(me[t.state.refKey],t).get().then(function(e){return e.docs.map(function(e){return me[t.state.refKey].doc(e.ref.id)})})},remove:function(e,n){var t=e.state,r=e.rootState,o=e.dispatch,i=me[t.refKey].doc(n).delete(),a=s.map(function(t){var e=r[t][t].filter(function(e){return e[u+"Id"]===n}).map(function(e){return me[t].doc(e.id).delete()});return Promise.all(e)});return a.push(i),o("saveTransaction",Promise.all(a),{root:!0})}}}},$e.prototype.documentMixin=function(e,t){var n=t.fields,r=t.embeddedIn,o=t.embedsMany,i=t.belongsTo,a=t.hasAndBelongsToMany,u=this,s=e,c=b(s),d=r,l=o||[],f=i||[],m=a||[],h={props:{store:{type:Object,required:!0},id:{type:String,required:!0},docRef:{type:Object,required:!0}},data:function(){return{parentPropName:d,collectionName:c}},computed:{$_documentMixin_docState:function(){var t=this;return this.$_documentMixin_moduleFullState[this.collectionName].find(function(e){return e.id===t.id})||{}},$_documentMixin_moduleFullState:function(){return this.store.state[this.$_documentMixin_moduleName]},$_documentMixin_moduleName:function(){return this.parentPropName?this.collectionName+"-"+this[this.parentPropName].id:this.collectionName}},methods:{update:function(e){e.id=this.id,this.store.dispatch(this.$_documentMixin_moduleAccessorName("update"),e)},destroy:function(){var t=this,e=l.map(function(e){return t.$_documentMixin_get(e,{setRef:!0}).then(function(e){return Promise.all(e.map(function(e){return e.destroy()}))})});return e.push(this.store.dispatch(this.$_documentMixin_moduleAccessorName("remove"),this.id)),Promise.all(e).then(function(){return t.$_documentMixin_unregisterDynamicModules(l)})},$_documentMixin_get:function(e,t){var n=this;void 0===t&&(t={});var r=this.$_documentMixin_submoduleAccessorName(e,"get"),o=u.lookupModel(e);return this.$_documentMixin_registerDynamicModule(e,this.docRef.collection(e),t),this.store.dispatch(r).then(function(e){return e.map(function(e){var t={propsData:{store:n.store,id:e.id,docRef:e}};return t.propsData[s]=n,new o(t)})})},$_documentMixin_findOrCreateModule:function(e){return pe[e]=pe[e]||u.vuexModule({name:e}),pe[e]},$_documentMixin_registerDynamicModule:function(e,t,n){void 0===n&&(n={}),ve[this.$_documentMixin_submoduleName(e)]||(ve[this.$_documentMixin_submoduleName(e)]=!0,this.store.registerModule(this.$_documentMixin_submoduleName(e),this.$_documentMixin_findOrCreateModule(e)),!1!==n.setRef&&this.store.dispatch(this.$_documentMixin_submoduleAccessorName(e,"setRef"),{ref:t,parentDocId:this.id}))},$_documentMixin_unregisterDynamicModules:function(e){var t=this;return Promise.all(e.map(function(e){return t.store.dispatch(t.$_documentMixin_submoduleAccessorName(e,"unsetRef")).then(function(){t.store.unregisterModule(t.$_documentMixin_submoduleName(e)),delete ve[t.$_documentMixin_submoduleName(e)]})}))},$_documentMixin_moduleAccessorName:function(e){return this.$_documentMixin_moduleName+"/"+e},$_documentMixin_submoduleName:function(e){return e+"-"+this.id},$_documentMixin_submoduleAccessorName:function(e,t){return this.$_documentMixin_submoduleName(e)+"/"+t},$_documentMixin_submoduleCollectionState:function(e){return this.$_documentMixin_submoduleFullState(e)[e]||[]},$_documentMixin_submoduleFullState:function(e){return this.store.state[this.$_documentMixin_submoduleName(e)]||{}}}};return d&&(h.props[d]={type:Object,required:!0}),n.forEach(function(e){h.computed[e]=function(){return this.$_documentMixin_docState[e]}}),l.forEach(function(o){var i=u.lookupModel(o);h.computed[o]=function(){var n=this,r=this.docRef.collection(o);this.$_documentMixin_registerDynamicModule(o,r);var e=this.$_documentMixin_submoduleCollectionState(o).map(function(e){var t={propsData:{store:n.store,id:e.id,docRef:r.doc(e.id)}};return t.propsData[s]=n,new i(t)});return e.create=function(e){var t=n.$_documentMixin_submoduleAccessorName(o,"add");return n.store.dispatch(t,e)},e}}),f.forEach(function(r){var o=u.lookupModel(r);h.computed[r]=function(){var e=this.docRef.firestore.collection(r),t=this.$_documentMixin_docState[r+"Id"],n={propsData:{store:this.store,id:t,docRef:e.doc(t)}};return new o(n)}}),m.forEach(function(i){var n=[c,i].sort().join("_"),a=u.lookupModel(i);h.computed[i]=function(){var r=this,o=this.docRef.firestore.collection(i);return this.store.state[n][n].filter(function(e){return e[c+"Id"]===r.id}).map(function(e){var t=e[i+"Id"],n={propsData:{store:r.store,id:t,docRef:o.doc(t)}};return n.propsData[s]=r,new a(n)})};var e=b.singular(i);e=function(e,t){t=Object.assign({pascalCase:!1},t);var n=function(e){return t.pascalCase?e.charAt(0).toUpperCase()+e.slice(1):e};return 0===(e=Array.isArray(e)?e.map(function(e){return e.trim()}).filter(function(e){return e.length}).join("-"):e.trim()).length?"":1===e.length?t.pascalCase?e.toUpperCase():e.toLowerCase():/^[a-z\d]+$/.test(e)?n(e):(e!==e.toLowerCase()&&(e=function(e){for(var t=!1,n=!1,r=!1,o=0;o<e.length;o++){var i=e[o];t&&/[a-zA-Z]/.test(i)&&i.toUpperCase()===i?(e=e.slice(0,o)+"-"+e.slice(o),r=n,n=!(t=!1),o++):n&&r&&/[a-zA-Z]/.test(i)&&i.toLowerCase()===i?(e=e.slice(0,o-1)+"-"+e.slice(o-1),r=n,t=!(n=!1)):(t=i.toLowerCase()===i,r=n,n=i.toUpperCase()===i)}return e}(e)),n(e=e.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(e,t){return t.toUpperCase()})))}(e,{pascalCase:!0}),h.methods["add"+e]=function(e){var t={};return t.id=c<=i?this.id+"_"+e:e+"_"+this.id,!!this.store.state[n][n].find(function(e){return e.id===t.id})?Promise.resolve(null):(t[c+"Id"]=this.id,t[i+"Id"]=e,this.store.dispatch(n+"/addWithId",t))}}),h},$e.prototype.documentClassMethods=function(e){var t=e.store,n=e.db,r=e.klass,o=e.collectionName,i=e.joinsWith,a=o;pe[o]=this.vuexModule({name:o,joinsWith:i}),t.registerModule(a,pe[o]),r.setCollectionRef=function(){var e=n.collection(o);return t.dispatch(o+"/setRef",{ref:e,parentDocId:null}),e},r.all=function(){return t.state[a][o]},r.create=function(e){return t.dispatch(a+"/add",e)}},$e.firebaseMutations=t,$e});